<ion-header>
  <ion-toolbar>
    <ion-title>Slot Disponibili</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="close()">
        <ion-icon name="close-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="trainer-info" *ngIf="trainer">
    <h2>{{ trainer.full_name }}</h2>
    <p>{{ trainer.specialization }}</p>
    
    <div class="rating" *ngIf="trainer.rating">
      <ion-icon name="star" color="warning"></ion-icon>
      <span>{{ trainer.rating }} / 5</span>
    </div>
  </div>

  <div class="date-selector">
    <ion-item lines="none">
      <ion-label>Seleziona data</ion-label>
      <ion-datetime-button datetime="date-select"></ion-datetime-button>
    </ion-item>
    
    <ion-modal [keepContentsMounted]="true">
      <ng-template>
        <ion-datetime 
          id="date-select"
          presentation="date"
          [min]="minDate"
          [value]="selectedDate"
          (ionChange)="onDateChange($event)">
        </ion-datetime>
      </ng-template>
    </ion-modal>
  </div>

  <div class="slots-container">
    <h3>Orari disponibili per {{ selectedDate | date:'dd/MM/yyyy' }}</h3>
    
    <div class="loading-container" *ngIf="isLoading">
      <ion-spinner name="dots"></ion-spinner>
      <p>Caricamento slot disponibili...</p>
    </div>
    
    <div class="empty-slots" *ngIf="!isLoading && availableSlots.length === 0">
      <ion-text color="medium">
        <p>Nessuno slot disponibile per la data selezionata</p>
      </ion-text>
    </div>
    
    <ion-list *ngIf="!isLoading && availableSlots.length > 0">
      <ion-item *ngFor="let slot of availableSlots" class="slot-item">
        <div class="slot-info">
          <div class="slot-time">
            <ion-icon name="time-outline"></ion-icon>
            <span>{{ slot.start_time | date:'HH:mm' }} - {{ slot.end_time | date:'HH:mm' }}</span>
          </div>
          
          <div class="slot-availability">
            <span>Posti disponibili: {{ slot.available_spots }} / {{ slot.max_clients }}</span>
          </div>
        </div>
        
        <ion-button slot="end" [disabled]="slot.available_spots === 0" (click)="bookSlot(slot.id)">
          Prenota
        </ion-button>
      </ion-item>
    </ion-list>
  </div>
</ion-content>
